# تخزين فيديوهات الكورسات على Amazon S3

هذا الملف يشرح كيفية إعداد واستخدام Amazon S3 لتخزين فيديوهات الكورسات في المنصة التعليمية.

## لماذا نستخدم S3 لتخزين الفيديوهات؟

1. **أداء أفضل**: الفيديوهات تأخذ مساحة كبيرة وتستهلك باندويدث كثير، فلما تكون على سيرفر منفصل، ده بيخلي سيرفر الموقع الأساسي يشتغل أسرع.

2. **أمان أكتر**: لو حصل اختراق للموقع، الفيديوهات هتكون محمية في مكان تاني.

3. **سهولة في التوسع**: لو الموقع كبر، ممكن تزود سيرفرات الفيديو بسهولة بدون ما تأثر على الموقع نفسه.

4. **تحسين الأداء للمستخدمين**: S3 يستخدم CDN (شبكة توصيل المحتوى) عشان يوصل الفيديوهات للمستخدمين من أقرب سيرفر ليهم.

## متطلبات الإعداد

1. حساب على Amazon Web Services (AWS)
2. إنشاء "bucket" على S3
3. إنشاء مفاتيح وصول (Access Keys) للـ API

## خطوات الإعداد

### 1. إنشاء حساب AWS وإعداد S3 Bucket

1. قم بإنشاء حساب على [AWS](https://aws.amazon.com/) أو استخدم حساب موجود
2. انتقل إلى خدمة S3 من لوحة التحكم
3. انقر على "Create bucket"
4. اختر اسم فريد للـ bucket (مثال: `your-app-videos`)
5. اختر المنطقة (Region) الأقرب لمستخدميك
6. اضبط إعدادات الوصول (يفضل أن تكون خاصة)
7. أكمل إنشاء الـ bucket

### 2. إنشاء مفاتيح الوصول (Access Keys)

1. انتقل إلى "IAM" من لوحة تحكم AWS
2. انشئ مستخدم جديد أو استخدم مستخدم موجود
3. أضف سياسة (Policy) تسمح بالوصول إلى S3 (مثل `AmazonS3FullAccess`)
4. قم بإنشاء مفاتيح وصول (Access Key و Secret Key)
5. احفظ هذه المفاتيح بشكل آمن

### 3. إعداد ملف .env

قم بإضافة المعلومات التالية إلى ملف `.env` الخاص بالتطبيق:

```
FILESYSTEM_DISK=s3
FILESYSTEM_CLOUD=s3

AWS_ACCESS_KEY_ID=your_access_key
AWS_SECRET_ACCESS_KEY=your_secret_key
AWS_DEFAULT_REGION=your_region
AWS_BUCKET=your_bucket_name
AWS_URL=https://your-bucket-name.s3.amazonaws.com
AWS_ENDPOINT=https://s3.your-region.amazonaws.com
AWS_USE_PATH_STYLE_ENDPOINT=false
```

## كيفية استخدام S3 في التطبيق

بعد إكمال الإعدادات، سيقوم التطبيق تلقائيًا بتخزين الفيديوهات الجديدة على S3 بدلاً من التخزين المحلي.

### ملاحظات هامة:

1. **الفيديوهات القديمة**: الفيديوهات التي تم رفعها سابقًا ستظل في التخزين المحلي. إذا أردت نقلها إلى S3، ستحتاج إلى عمل سكريبت خاص بذلك.

2. **الأمان**: تأكد من ضبط صلاحيات الوصول للـ bucket بشكل صحيح لمنع الوصول غير المصرح به.

3. **التكلفة**: لاحظ أن استخدام S3 يتضمن تكاليف حسب حجم التخزين وحركة البيانات. راجع [أسعار AWS S3](https://aws.amazon.com/s3/pricing/) للتفاصيل.

## استكشاف الأخطاء وإصلاحها

إذا واجهت مشاكل في رفع أو عرض الفيديوهات من S3:

1. تأكد من صحة مفاتيح الوصول في ملف `.env`
2. تحقق من إعدادات الصلاحيات في الـ bucket
3. راجع سجلات الخطأ في Laravel (`storage/logs/laravel.log`)
4. تأكد من تثبيت حزمة `league/flysystem-aws-s3-v3` باستخدام Composer

## المزيد من المعلومات

- [وثائق Laravel للتعامل مع التخزين](https://laravel.com/docs/10.x/filesystem)
- [وثائق AWS S3](https://docs.aws.amazon.com/s3/index.html)
